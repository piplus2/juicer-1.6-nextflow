params {
    default_process_resources = [
        cpus  : (params.default_cpus ?: 4),
        memory: (params.default_memory_gb ? params.default_memory_gb.GB : 16.GB),
        time  : (params.default_time ?: '48h')
    ]

    gpu_process_resources = [
        cpus  : (params.default_gpu_cpus ?: 8),
        memory: (params.default_gpu_memory_gb ? params.default_gpu_memory_gb.GB : 64.GB),
        time  : (params.default_gpu_time ?: '48h')
    ]

    process_resources = [
        COUNT_LIGATIONS      : [
            cpus  : (params.count_ligations_cpus ?: 2),
            memory: (params.count_ligations_memory_gb ? params.count_ligations_memory_gb.GB : 4.GB),
            time  : (params.count_ligations_time ?: '6h')
        ],
        BWA_ALIGN            : [
            cpus  : (params.align_cpus ?: (params.threads ?: 16)),
            memory: (params.align_memory_gb ? params.align_memory_gb.GB : 64.GB),
            time  : (params.align_time ?: '48h')
        ],
        FRAGMENT             : [
            cpus  : (params.fragment_cpus ?: 2),
            memory: (params.fragment_memory_gb ? params.fragment_memory_gb.GB : 8.GB),
            time  : (params.fragment_time ?: '24h')
        ],
        SORT                 : [
            cpus  : (params.sort_cpus ?: 4),
            memory: (params.sort_memory_gb ? params.sort_memory_gb.GB : 32.GB),
            time  : (params.sort_time ?: '24h')
        ],
        CHIMERIC             : [
            cpus  : (params.chimeric_cpus ?: 4),
            memory: (params.chimeric_memory_gb ? params.chimeric_memory_gb.GB : 16.GB),
            time  : (params.chimeric_time ?: '24h')
        ],
        MERGE_SORT           : [
            cpus  : (params.merge_sort_cpus ?: 4),
            memory: (params.merge_sort_memory_gb ? params.merge_sort_memory_gb.GB : 16.GB),
            time  : (params.merge_sort_time ?: '24h')
        ],
        REMOVE_DUPLICATES    : [
            cpus  : (params.remove_duplicates_cpus ?: 4),
            memory: (params.remove_duplicates_memory_gb ? params.remove_duplicates_memory_gb.GB : 12.GB),
            time  : (params.remove_duplicates_time ?: '24h')
        ],
        REMOVE_DUPLICATES_SAM: [
            cpus  : (params.remove_duplicates_sam_cpus ?: 4),
            memory: (params.remove_duplicates_sam_memory_gb ? params.remove_duplicates_sam_memory_gb.GB : 12.GB),
            time  : (params.remove_duplicates_sam_time ?: '24h')
        ],
        SAM_TO_BAM           : [
            cpus  : (params.sam_to_bam_cpus ?: 8),
            memory: (params.sam_to_bam_memory_gb ? params.sam_to_bam_memory_gb.GB : 24.GB),
            time  : (params.sam_to_bam_time ?: '24h')
        ],
        MERGE_SORT_SAM       : [
            cpus  : (params.merge_sort_sam_cpus ?: 8),
            memory: (params.merge_sort_sam_memory_gb ? params.merge_sort_sam_memory_gb.GB : 32.GB),
            time  : (params.merge_sort_sam_time ?: '24h')
        ],
        MAKE_HEADERFILE      : [
            cpus  : (params.make_headerfile_cpus ?: 1),
            memory: (params.make_headerfile_memory_gb ? params.make_headerfile_memory_gb.GB : 2.GB),
            time  : (params.make_headerfile_time ?: '2h')
        ],
        STATS                : [
            cpus  : (params.stats_cpus ?: 4),
            memory: (params.stats_memory_gb ? params.stats_memory_gb.GB : 32.GB),
            time  : (params.stats_time ?: '36h')
        ],
        GEN_HIC_FILES        : [
            cpus  : (params.gen_hic_files_cpus ?: 6),
            memory: (params.gen_hic_files_memory_gb ? params.gen_hic_files_memory_gb.GB : 48.GB),
            time  : (params.gen_hic_files_time ?: '48h')
        ],
        JUICER_TOOLS_PRE_Q1  : [
            cpus  : (params.juicer_tools_pre_q1_cpus ?: 4),
            memory: (params.juicer_tools_pre_q1_memory_gb ? params.juicer_tools_pre_q1_memory_gb.GB : 32.GB),
            time  : (params.juicer_tools_pre_q1_time ?: '36h')
        ],
        JUICER_TOOLS_PRE_Q30 : [
            cpus  : (params.juicer_tools_pre_q30_cpus ?: 4),
            memory: (params.juicer_tools_pre_q30_memory_gb ? params.juicer_tools_pre_q30_memory_gb.GB : 32.GB),
            time  : (params.juicer_tools_pre_q30_time ?: '36h')
        ],
        HIC_STATS            : [
            cpus  : (params.hic_stats_cpus ?: 4),
            memory: (params.hic_stats_memory_gb ? params.hic_stats_memory_gb.GB : 24.GB),
            time  : (params.hic_stats_time ?: '24h')
        ],
        ARROWHEAD            : [
            cpus  : (params.arrowhead_cpus ?: params.gpu_process_resources.cpus),
            memory: (params.arrowhead_memory_gb ? params.arrowhead_memory_gb.GB : params.gpu_process_resources.memory),
            time  : (params.arrowhead_time ?: params.gpu_process_resources.time)
        ],
        HICCUPS              : [
            cpus  : (params.hiccups_cpus ?: Math.max(8, params.gpu_process_resources.cpus)),
            memory: (params.hiccups_memory_gb ? params.hiccups_memory_gb.GB : 96.GB),
            time  : (params.hiccups_time ?: params.gpu_process_resources.time)
        ],
        MOTIF_FINDER         : [
            cpus  : (params.motif_finder_cpus ?: params.gpu_process_resources.cpus),
            memory: (params.motif_finder_memory_gb ? params.motif_finder_memory_gb.GB : 64.GB),
            time  : (params.motif_finder_time ?: params.gpu_process_resources.time)
        ]
    ]
}

process {
    withName: /.*COUNT_LIGATIONS/ {
        cpus   = params.process_resources.COUNT_LIGATIONS.cpus
        memory = params.process_resources.COUNT_LIGATIONS.memory
        time   = params.process_resources.COUNT_LIGATIONS.time
    }

    withName: /.*BWA_ALIGN/ {
        cpus   = params.process_resources.BWA_ALIGN.cpus
        memory = params.process_resources.BWA_ALIGN.memory
        time   = params.process_resources.BWA_ALIGN.time
    }

    withName: /.*FRAGMENT/ {
        cpus   = params.process_resources.FRAGMENT.cpus
        memory = params.process_resources.FRAGMENT.memory
        time   = params.process_resources.FRAGMENT.time
    }

    withName: /.*SORT$/ {
        cpus   = params.process_resources.SORT.cpus
        memory = params.process_resources.SORT.memory
        time   = params.process_resources.SORT.time
    }

    withName: /.*CHIMERIC/ {
        cpus   = params.process_resources.CHIMERIC.cpus
        memory = params.process_resources.CHIMERIC.memory
        time   = params.process_resources.CHIMERIC.time
    }

    withName: /.*MERGE_SORT$/ {
        cpus   = params.process_resources.MERGE_SORT.cpus
        memory = params.process_resources.MERGE_SORT.memory
        time   = params.process_resources.MERGE_SORT.time
    }

    withName: /.*REMOVE_DUPLICATES$/ {
        cpus   = params.process_resources.REMOVE_DUPLICATES.cpus
        memory = params.process_resources.REMOVE_DUPLICATES.memory
        time   = params.process_resources.REMOVE_DUPLICATES.time
    }

    withName: /.*REMOVE_DUPLICATES_SAM/ {
        cpus   = params.process_resources.REMOVE_DUPLICATES_SAM.cpus
        memory = params.process_resources.REMOVE_DUPLICATES_SAM.memory
        time   = params.process_resources.REMOVE_DUPLICATES_SAM.time
    }

    withName: /.*SAM_TO_BAM/ {
        cpus   = params.process_resources.SAM_TO_BAM.cpus
        memory = params.process_resources.SAM_TO_BAM.memory
        time   = params.process_resources.SAM_TO_BAM.time
    }

    withName: /.*MERGE_SORT_SAM/ {
        cpus   = params.process_resources.MERGE_SORT_SAM.cpus
        memory = params.process_resources.MERGE_SORT_SAM.memory
        time   = params.process_resources.MERGE_SORT_SAM.time
    }

    withName: /.*MAKE_HEADERFILE/ {
        cpus   = params.process_resources.MAKE_HEADERFILE.cpus
        memory = params.process_resources.MAKE_HEADERFILE.memory
        time   = params.process_resources.MAKE_HEADERFILE.time
    }

    withName: /.*STATS/ {
        cpus   = params.process_resources.STATS.cpus
        memory = params.process_resources.STATS.memory
        time   = params.process_resources.STATS.time
    }

    withName: /.*GEN_HIC_FILES/ {
        cpus   = params.process_resources.GEN_HIC_FILES.cpus
        memory = params.process_resources.GEN_HIC_FILES.memory
        time   = params.process_resources.GEN_HIC_FILES.time
    }

    withName: /.*JUICER_TOOLS_PRE_Q1/ {
        cpus   = params.process_resources.JUICER_TOOLS_PRE_Q1.cpus
        memory = params.process_resources.JUICER_TOOLS_PRE_Q1.memory
        time   = params.process_resources.JUICER_TOOLS_PRE_Q1.time
    }

    withName: /.*JUICER_TOOLS_PRE_Q30/ {
        cpus   = params.process_resources.JUICER_TOOLS_PRE_Q30.cpus
        memory = params.process_resources.JUICER_TOOLS_PRE_Q30.memory
        time   = params.process_resources.JUICER_TOOLS_PRE_Q30.time
    }

    withName: /.*HIC_STATS/ {
        cpus   = params.process_resources.HIC_STATS.cpus
        memory = params.process_resources.HIC_STATS.memory
        time   = params.process_resources.HIC_STATS.time
    }

    withName: /.*ARROWHEAD/ {
        cpus   = params.process_resources.ARROWHEAD.cpus
        memory = params.process_resources.ARROWHEAD.memory
        time   = params.process_resources.ARROWHEAD.time
    }

    withName: /.*HICCUPS/ {
        cpus   = params.process_resources.HICCUPS.cpus
        memory = params.process_resources.HICCUPS.memory
        time   = params.process_resources.HICCUPS.time
    }

    withName: /.*MOTIF_FINDER/ {
        cpus   = params.process_resources.MOTIF_FINDER.cpus
        memory = params.process_resources.MOTIF_FINDER.memory
        time   = params.process_resources.MOTIF_FINDER.time
    }
}
